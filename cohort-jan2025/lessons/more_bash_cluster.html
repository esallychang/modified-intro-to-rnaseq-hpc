<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Overview | GitHub Pages Test</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Overview" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction to bulk RNA-seq" />
<meta property="og:description" content="Introduction to bulk RNA-seq" />
<link rel="canonical" href="https://esallychang.github.io/modified-intro-to-rnaseq-hpc/cohort-jan2025/lessons/more_bash_cluster.html" />
<meta property="og:url" content="https://esallychang.github.io/modified-intro-to-rnaseq-hpc/cohort-jan2025/lessons/more_bash_cluster.html" />
<meta property="og:site_name" content="GitHub Pages Test" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Overview" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Introduction to bulk RNA-seq","headline":"Overview","url":"https://esallychang.github.io/modified-intro-to-rnaseq-hpc/cohort-jan2025/lessons/more_bash_cluster.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style" type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/modified-intro-to-rnaseq-hpc/cohort-jan2025/assets/css/style.css?v=8eca8df006e778863fd37408e6d5e641f557c872">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/modified-intro-to-rnaseq-hpc/cohort-jan2025/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    <header class="page-header" role="banner">
      <h1 class="project-name">Overview</h1>
      <h2 class="project-tagline">Introduction to bulk RNA-seq</h2>
      
        <a href="https://github.com/esallychang/modified-intro-to-rnaseq-hpc" class="btn">View on GitHub</a>
      
      
    </header>

    <main id="content" class="main-content" role="main">
      <h2 id="overview">Overview</h2>

<ul>
  <li><a href="#alias">Creating shortcuts or <code class="language-plaintext highlighter-rouge">alias</code></a></li>
  <li><a href="#rsync">Copying files using <code class="language-plaintext highlighter-rouge">scp</code> and <code class="language-plaintext highlighter-rouge">rsync</code></a></li>
  <li><a href="#symlink">Symbolic Links or “sym links”</a></li>
</ul>

<hr />

<h2 id="setting-up-some-aliases-">Setting up some <code class="language-plaintext highlighter-rouge">alias</code>es <a name="alias"></a></h2>

<p>In your terminal, do the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span>

<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>

<span class="nv">$ </span>ll
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">ll</code> should have output the same thing as <code class="language-plaintext highlighter-rouge">ls -l</code>. Why does it work this way? This is because the HMS-RC folks have internally setup what is called an <strong>alias</strong>.</p>

<p>A <strong>shell alias is a shortcut to reference a command</strong>. It can be used to avoid typing long commands. For common patterns it can reduce keystrokes and improve efficiency. A simple example is setting default options on commands to avoid having to type them each time a command is run.</p>

<p>For example suppose that because you are just starting out on the cluster, and you prefer to confirm deleting a file before using the <code class="language-plaintext highlighter-rouge">rm</code> command. Remember that the <code class="language-plaintext highlighter-rouge">rm</code> command supports this with the <code class="language-plaintext highlighter-rouge">-i</code> option. To avoid forgetting to use the <code class="language-plaintext highlighter-rouge">-i</code> option each time, an alias can be created so that each time <code class="language-plaintext highlighter-rouge">rm</code> is run it will use the <code class="language-plaintext highlighter-rouge">-i</code> option and prompt the user to confirm.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">alias rm</span><span class="o">=</span><span class="s1">'rm -i'</span>
</code></pre></div></div>

<p>However, this alias is only going to be available to you while that Terminal window is open. If you wanted to <strong>use that alias all the time, what would you do?</strong></p>

<p>You would add it to <code class="language-plaintext highlighter-rouge">~/.bashrc</code>! Let’s open <code class="language-plaintext highlighter-rouge">~/.bashrc</code> and add a few commands to it. At the bottom of the file you should see a header titled “User specific aliases”. Under that header go ahead and add the alias.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>vim ~/.bashrc
</code></pre></div></div>

<p>Add in a line at the end of your <code class="language-plaintext highlighter-rouge">.bashrc</code> file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alias rm='rm -i'
</code></pre></div></div>

<p>Now, we can source the <code class="language-plaintext highlighter-rouge">.bashrc</code> file for the alias to take effect and we can try it out. You should see the question `
remove draft.txt?<code class="language-plaintext highlighter-rouge"> and here you can answer </code>n` for No.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">source</span> ~/.bashrc

<span class="nv">$ </span><span class="nb">rm</span>  ~/unix_lesson/other/draft.txt 
</code></pre></div></div>

<p>As we mentioned, aliases are super helpful for long commands that we are repeatedly having to tyoe out. A good example of this is the <code class="language-plaintext highlighter-rouge">srun</code> command for starting and interactive session. <strong>First exit the interactive session and get on a login node, if you are not there already.</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">alias </span><span class="nv">o2i</span><span class="o">=</span><span class="s1">'srun --pty -p interactive -t 0-12:00 --mem 2G --reservation=HBC /bin/bash'</span>
</code></pre></div></div>

<p>Now you can test it out!</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>o2i
</code></pre></div></div>

<p>Similar to what we did above, you can put this (or a similar) command in the <code class="language-plaintext highlighter-rouge">.bash_profile</code> file so it is available when you log on next time.</p>

<blockquote>
  <h3 id="bashrc-versus-bash_profile"><code class="language-plaintext highlighter-rouge">.bashrc</code> versus <code class="language-plaintext highlighter-rouge">.bash_profile</code></h3>
  <p><code class="language-plaintext highlighter-rouge">.bash_profile</code> is executed for login shells, while <code class="language-plaintext highlighter-rouge">.bashrc</code> is executed for interactive non-login shells. When you login (type username and password) to O2 the <code class="language-plaintext highlighter-rouge">.bash_profile</code> is executed. So if you want the alias available <strong>only</strong> when you login, you will want to put it in your <code class="language-plaintext highlighter-rouge">.bash_profile</code>.</p>
</blockquote>

<h2 id="copying-files-to-and-from-the-cluster-">Copying files to and from the cluster <a name="rsync"></a></h2>

<p>So far we have used FileZilla to copy files over from O2, but there are other way to do so using the command line interface. When you obtain your data from the sequencing facility, it will likely be stored on some remote computer and they will give you login credentials which will allow you to access it. There are various commands that can be used to help you copy those files from the remote computer over to 1) your local computer, 2) O2, or 3) whatever cluster environment you plan to work on. We present a few options here.</p>

<h3 id="scp"><code class="language-plaintext highlighter-rouge">scp</code></h3>

<p>Similar to the <code class="language-plaintext highlighter-rouge">cp</code> command to copy there is a command that allows you to <strong>securely copy files between computers</strong>. The command is called <code class="language-plaintext highlighter-rouge">scp</code> and allows files to be copied to, from, or between different hosts. It uses ssh for data transfer and provides the same authentication and same level of security as ssh.</p>

<p>In the example below, the first argument is the <strong>location on the remote server</strong> and the second argument is the <strong>destination on your local machine</strong>.</p>

<blockquote>
  <p><em>You can also do this in the opposite direction by swapping the arguments.</em></p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>scp username@transfer.rc.hms.harvard.edu:/path/to/file_on_O2 Path/to/directory/local_machine
</code></pre></div></div>

<p>Let’s try copying over the README file from your <code class="language-plaintext highlighter-rouge">unix_lesson</code> folder. <strong>First open up a new terminal window.</strong>  Look and see where you currently are:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">pwd</span>
</code></pre></div></div>

<p>Then type in:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>scp rc_trainingXX@transfer.rc.hms.harvard.edu:~/unix_lesson/other/draft.txt  <span class="nb">.</span>
</code></pre></div></div>

<p>Now see that the file has transferred over:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>less draft.txt
</code></pre></div></div>

<blockquote>
  <p><strong>NOTE:</strong> Windows users may encounter a permissions error when using <code class="language-plaintext highlighter-rouge">scp</code> to copy over locally. We are not sure how to troubleshoot this, but will update materials as we obtain more information.</p>
</blockquote>

<h3 id="rsync"><code class="language-plaintext highlighter-rouge">rsync</code></h3>

<p><code class="language-plaintext highlighter-rouge">rsync</code> is used to copy or synchronize data between directories. It has many advantages over <code class="language-plaintext highlighter-rouge">cp</code>, <code class="language-plaintext highlighter-rouge">scp</code> etc. It works in a specific direction, i.e. from the first directory <strong>to</strong> the second directory, similar to <code class="language-plaintext highlighter-rouge">cp</code>.</p>

<p><strong>Salient Features of <code class="language-plaintext highlighter-rouge">rsync</code></strong></p>

<ul>
  <li>If the command (or transfer) is interrupted, you can start it again and <em>it will restart from where it was interrupted</em>.</li>
  <li>Once a folder has been synced between 2 locations, the next time you run <code class="language-plaintext highlighter-rouge">rsync</code> it will <em>only update and not copy everything over again</em>.</li>
  <li>It runs a check to ensure that every file it is “syncing” over is the exact same in both locations. This check is run using a version of <a href="https://en.wikipedia.org/wiki/Checksum">“checksum”</a> which ensures the data integrity during the data transfer process.</li>
</ul>

<blockquote>
  <p>You can run the checksum function yourself when transferring large datasets without <code class="language-plaintext highlighter-rouge">rsync</code> using one of the following commands (or similar): <code class="language-plaintext highlighter-rouge">md5</code>, <code class="language-plaintext highlighter-rouge">md5sum</code>.</p>
</blockquote>

<h3 id="between-directories-on-the-same-machine">Between directories on the same machine</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#DO NOT RUN</span>
<span class="nv">$ </span>rsync <span class="nt">-av</span> ~/large_dataset/. /n/groups/dir/groupdata/
</code></pre></div></div>

<h3 id="between-different-machines">Between different machines</h3>

<p>When copying over large datasets to or from a remote machine, <code class="language-plaintext highlighter-rouge">rsync</code> works similarly to <code class="language-plaintext highlighter-rouge">scp</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#DO NOT RUN</span>
<span class="nv">$ </span>rsync <span class="nt">-av</span> <span class="nt">-e</span> ssh testfile username@transfer.rc.hms.harvard.edu:~/large_files/
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">a</code> is for archive - means it preserves permissions (owners, groups), times, symbolic links, and devices.</li>
  <li><code class="language-plaintext highlighter-rouge">v</code> is for verbosity - means that it prints on the screen what is being copied</li>
  <li><code class="language-plaintext highlighter-rouge">-e ssh</code> is for encryption - means that we want to use the ssh protocol for encryption of the file transfer</li>
</ul>

<p><em>More helpful information and examples using rsync can be found <a href="https://www.comentum.com/rsync.html">at this link</a></em></p>

<blockquote>
  <p>Please do not use O2’s login nodes for transferring large datasets (like fastq files) between your computer and O2 with <code class="language-plaintext highlighter-rouge">rsync</code> or <code class="language-plaintext highlighter-rouge">scp</code>. Instead, use the transfer nodes <code class="language-plaintext highlighter-rouge">ssh eCommons@transfer.rc.hms.harvard.edu</code>.</p>
</blockquote>

<h2 id="symbolic-links-or-sym-links-">Symbolic Links or “sym links” <a name="symlink"></a></h2>

<p>Symbolic links are like shortcuts you may create on your laptop. A sym link makes it appear as if the linked object is actually there. It can be useful to access a file from multiple locations without creating copies and without using much disk space. (Symlinks are only a few bytes in size.)</p>

<p>Let’s check out an example of a folder with lots of symlinks.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-l</span> /n/app/bcbio/tools/bin/
</code></pre></div></div>

<p>Now, let’s create a sym link in our home directory for the same <code class="language-plaintext highlighter-rouge">unix_lesson</code> folder we had originally copied over.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span>

<span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-s</span> /n/groups/hbctraining/unix_lesson/ unix_lesson_sym

<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
</code></pre></div></div>

<p>We recommend that you create something like this for your raw data so it does not accidentally get corrupted or overwritten.</p>

<blockquote>
  <p>Note: a “hard” link (just <code class="language-plaintext highlighter-rouge">ln</code> without the <code class="language-plaintext highlighter-rouge">-s</code> option) is very different. Always use “ln -s” unless you really know what you’re doing!</p>
</blockquote>

<h2 id="additional-topics">Additional topics</h2>

<p>If you are interested in learning more about regular expressions (regex) and the tools <code class="language-plaintext highlighter-rouge">awk</code> and <code class="language-plaintext highlighter-rouge">sed1</code>, you can find more information in the <a href="https://hbctraining.github.io/Intro-to-shell-flipped/lessons/extra_bash_tools.html">“extra_bash_tools”</a> lesson.</p>

<hr />
<p><em>This lesson has been developed by members of the teaching team at the <a href="http://bioinformatics.sph.harvard.edu/">Harvard Chan Bioinformatics Core (HBC)</a>. These are open access materials distributed under the terms of the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution license</a> (CC BY 4.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</em></p>


      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="https://github.com/esallychang/modified-intro-to-rnaseq-hpc">modified-intro-to-rnaseq-hpc</a> is maintained by <a href="https://github.com/esallychang">esallychang</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </main>
  </body>
</html>
