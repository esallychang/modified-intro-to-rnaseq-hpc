<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Quality control: Assessing FASTQC results | GitHub Pages Test</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Quality control: Assessing FASTQC results" />
<meta name="author" content="Mary Piper, Radhika Khetani - Adapted by Sally Chang @ NICHD" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction to bulk RNA-seq" />
<meta property="og:description" content="Introduction to bulk RNA-seq" />
<link rel="canonical" href="https://esallychang.github.io/modified-intro-to-rnaseq-hpc/lessons/07_qc_fastqc_assessment.html" />
<meta property="og:url" content="https://esallychang.github.io/modified-intro-to-rnaseq-hpc/lessons/07_qc_fastqc_assessment.html" />
<meta property="og:site_name" content="GitHub Pages Test" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-10-04T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Quality control: Assessing FASTQC results" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mary Piper, Radhika Khetani - Adapted by Sally Chang @ NICHD"},"dateModified":"2024-10-04T00:00:00+00:00","datePublished":"2024-10-04T00:00:00+00:00","description":"Introduction to bulk RNA-seq","headline":"Quality control: Assessing FASTQC results","mainEntityOfPage":{"@type":"WebPage","@id":"https://esallychang.github.io/modified-intro-to-rnaseq-hpc/lessons/07_qc_fastqc_assessment.html"},"url":"https://esallychang.github.io/modified-intro-to-rnaseq-hpc/lessons/07_qc_fastqc_assessment.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style" type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/modified-intro-to-rnaseq-hpc/assets/css/style.css?v=57e2d19053fb95686fdf7b0c6d67a5efc1620535">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/modified-intro-to-rnaseq-hpc/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    <header class="page-header" role="banner">
      <h1 class="project-name">Quality control: Assessing FASTQC results</h1>
      <h2 class="project-tagline">Introduction to bulk RNA-seq</h2>
      
        <a href="https://github.com/esallychang/modified-intro-to-rnaseq-hpc" class="btn">View on GitHub</a>
      
      
    </header>

    <main id="content" class="main-content" role="main">
      <h2 id="learning-objectives">Learning Objectives:</h2>

<ul>
  <li>Evaluate the quality of your NGS data using FastQC</li>
</ul>

<h2 id="assessing-the-results-from-fastqc">Assessing the results from FastQC</h2>

<p>For each individual FASTQ file that is input to FastQC, there are <strong>two output files that are generated</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-lh</span> ~/rnaseq/results/fastqc/
</code></pre></div></div>

<ol>
  <li>The first is <strong>an HTML file</strong> which is a self-contained document with various graphs embedded into it. Each of the graphs evaluate different quality aspects of our data, we will discuss in more detail in this lesson.</li>
  <li>Alongside the HTML file is <strong>a zip file</strong> (with the same name as the HTML file, but with .zip added to the end). This file contains the different plots from the report as separate image files but also contains data files which are designed to be easily parsed to allow for a more detailed and automated evaluation of the raw data on which the QC report is built.</li>
</ol>

<h2 id="viewing-the-html-report">Viewing the HTML report</h2>

<p>We will only need to look at the HTML report for a given input file. It is not possible to view HTML files directly on the cluster from the command line. We will view the HTML result for <code class="language-plaintext highlighter-rouge">Mov10_oe_1.subset.fq</code> by <a href="https://hpc.nih.gov/docs/hpcdrive.html">locally mounting an HPC System Directory</a> so you can access the HTMLs locally.</p>

<blockquote>
  <h3 id="what-does-this-do">What does this do?</h3>

  <p>The <a href="https://hpc.nih.gov/storage">HPC System Directories</a>, which include /home, /data, and /scratch, can be mounted to your local workstation if you are on the NIH network or VPN, allowing you to easily drag and drop files between the two places. Note that this is most suitable for transferring small file. Users transferring large amounts of data to and from the HPC systems should continue to use scp/sftp/globus.</p>

  <p>Mounting your HPC directories to your local system is particularly userful for viewing HTML reports generated in the course of your analyses on the HPC systems. For these cases, you should be able to navigate to and select the desired html file to open them in your local system’s web browser.</p>
</blockquote>

<p>Follow the instructions on this Biowulf page for your operating system, and navigate to the <code class="language-plaintext highlighter-rouge">results/fastqc</code> directory.</p>

<h2 id="interpreting-the-html-report">Interpreting the HTML report</h2>

<p>Once you have found the html output for <code class="language-plaintext highlighter-rouge">Mov10_oe1</code> <strong>copy it over</strong> by double clicking it or drag it over to right hand side panel. Once you have the HTML file copied over to your laptop, you can leave the Filezilla interface. You can then locate the HTML file on your computer and open it up in a browser.</p>

<p>Now we can take a look at the metrics and assess the quality of our sequencing data!</p>

<p>FastQC has a really well documented <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">manual page</a> with <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/">detailed explanations</a> about every plot in the report.</p>

<p>Within our report, a summary of all of the modules is given on the left-hand side of the report. Don’t take the <strong>yellow “WARNING”s</strong> and <strong>red “FAIL”s</strong> too seriously; they should be interpreted as flags for modules to check out.</p>

<p><img src="../img/fastqc_summary.png" width="200" /></p>

<p>The first module gives the basic statistics for the sample. Generally it is a good idea to keep track of the total number of reads sequenced for each sample and to make sure the read length and %GC content is as expected.</p>

<p align="center">

<img src="../img/fastqc_basic_stats.png" width="400" />

</p>

<h3 id="per-base-sequence-quality">Per base sequence quality</h3>

<p>One of the most important analysis modules is the <strong>“Per base sequence quality”</strong> plot. This plot provides the distribution of quality scores at each position in the read across all reads. The y-axis gives the quality scores, while the x-axis represents the position in the read. The color coding of the plot denotes what are considered high, medium and low quality scores.</p>

<p>This plot can alert us to whether there were any problems occurring during sequencing and whether we might need to contact the sequencing facility.</p>

<p align="center">

<img src="../img/FastQC_seq_qual.png" />

</p>

<p>For example, the <strong>box plot</strong> at nucleotide 1 shows <strong>the distribution of quality scores for the first nucleotide of all reads</strong> in the <code class="language-plaintext highlighter-rouge">Mov10_oe_1</code> sample.</p>

<ul>
  <li>The yellow box represents the 25th and 75th percentiles.</li>
  <li>The red line is the median value.</li>
  <li>The whiskers are the 10th and 90th percentiles.</li>
  <li>The blue line represents the average quality score for the nucleotide.</li>
</ul>

<p>Based on these metrics, the quality scores for the first nucleotide are quite high, with nearly all reads having scores above 28.</p>

<p>The quality scores appear to drop going from the beginning toward the end of the reads. For reads generated by Illumina sequencing, this is not alarming and there are known causes for this drop in quality.</p>

<p><strong>For Illumina sequencing, the quality of the nucleotide base calls are related to the signal intensity and purity of the fluorescent signal</strong>. Low intensity fluorescence or the presence of multiple different fluorescent signals can lead to a drop in the quality score assigned to the nucleotide. Due to the nature of sequencing-by-synthesis there are some drops in quality that can be expected, but other quality issues can be indicative of a problem at the sequencing facility.</p>

<p>We will now <strong>explore different quality issues arising from the sequencing-by-synthesis used by Illumina</strong>, both expected and unexpected.</p>

<h4 id="expected-error-profiles">Expected Error Profiles</h4>

<p>As sequencing progresses from the first cycle to the last cycle we often anticipate a drop in the quality of the base calls. This is often due to signal decay and phasing as the sequencing run progresses.</p>

<ul>
  <li>
    <p><strong>Signal decay:</strong> As sequencing proceeds, the fluorescent signal intensity decays with each cycle, yielding decreasing quality scores at the <strong>3’ end</strong> of the read. This is due to:</p>

    <ol>
      <li>Degrading fluorophores</li>
      <li>A proportion of the strands in the cluster not being elongated</li>
    </ol>

    <p>Therefore, the proportion of signal being emitted continues to decrease with each cycle.</p>
  </li>
</ul>

<p align="center">

<img src="../img/qc_signal_decay.png" width="400" />

</p>

<ul>
  <li><strong>Phasing:</strong> As the number of cycles increases, the signal starts to blur as the cluster loses synchronicity, also yielding a decrease in quality scores at the <strong>3’ end</strong> of the read. As the cycles progress, some strands get random failure of nucleotides to incorporate due to:
    <ol>
      <li>Incomplete removal of the 3’ terminators and fluorophores</li>
      <li>Incorporation of nucleotides without effective 3’ terminators</li>
    </ol>
  </li>
</ul>

<p align="center">

<img src="../img/qc_phasing.png" width="500" />

</p>

<h4 id="worrisome-error-profiles">Worrisome Error Profiles</h4>

<ul>
  <li><strong>Overclustering:</strong> Sequencing facilities can overcluster the flow cells, which results in small distances between clusters and an overlap in the signals. The two clusters can be interpreted as a single cluster with mixed fluorescent signals being detected, decreasing signal purity, generating lower quality scores across the <strong>entire read</strong>.</li>
</ul>

<p align="center">

<img src="../img/qc_overclustering.png" width="800" />

</p>

<ul>
  <li>
    <p><strong>Instrumentation breakdown:</strong> Sequencing facilities can occasionally have issues with the sequencing instruments during a run. <strong>Any sudden drop in quality or a large percentage of low quality reads across the read could indicate a problem at the facility.</strong> Examples of such issues are shown below, including a manifold burst, cycles lost, and read 2 failure. For such data, the sequencing facility should be contacted for resolution, if possible.</p>

    <p><img src="../img/qc_manifold_burst.png" width="300" /></p>

    <p><img src="../img/qc_cycles_lost.png" width="300" /></p>

    <p><img src="../img/qc_read2_failed.png" width="350" /></p>
  </li>
</ul>

<h3 id="per-sequence-quality-scores">Per sequence quality scores</h3>

<p>The <strong>“Per sequence quality scores”</strong> plot gives you the average quality score on the x-axis and the number of sequences with that average on the y-axis. We hope the majority of our reads have a high average quality score with no large bumps at the lower quality values.</p>

<p align="center">

<img src="../img/fastqc_per_sequence_quality_scores.png" width="400" />

</p>

<p>This data has a small bump at a mean quality of 12. Since it doesn’t represent a large proportion of the data, it isn’t extremely worrisome, but it might be worth a quick check of the reads resulting in the poor quality scores.</p>

<h3 id="per-base-sequence-content">Per base sequence content</h3>

<p>The next plot gives the <strong>“Per base sequence content”</strong>, which always gives a FAIL for RNA-seq data. This is because the first 10-12 bases result from the ‘random’ hexamer priming that occurs during RNA-seq library preparation. This priming is not as random as we might hope giving an enrichment in particular bases for these intial nucleotides.</p>

<p align="center">

<img src="../img/fastqc_per_base_sequence_content.png" width="400" />

</p>

<h3 id="per-sequence-gc-content">Per sequence GC content</h3>

<p>The <strong>“Per sequence GC content”</strong> plot gives the GC distribution over all sequences. Generally is a good idea to note whether the GC content of the central peak corresponds to the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2909565/">expected % GC for the organism</a>. Also, the distribution should be normal unless over-represented sequences (sharp peaks on a normal distribution) or contamination with another organism (broad peak).</p>

<p>This plot would indicate some type of over-represented sequence with the sharp peaks, indicating either contamination or a highly over-expressed gene.</p>

<p align="center">

<img src="../img/fastqc_GC.png" width="400" />

</p>

<h3 id="sequence-duplication">Sequence duplication</h3>

<p>The next module explores numbers of duplicated sequences in the library. This plot can help identify a low complexity library, which could result from too many cycles of PCR amplification or too little starting material. For RNA-seq we don’t normally do anything to address this in the analysis, but if this were a pilot experiment, we might adjust the number of PCR cycles, amount of input, or amount of sequencing for future libraries. In this analysis we seem to have a large number of duplicated sequences, but this is expected due to the subset of data we are working with containing the over-expression of MOV10.</p>

<p align="center">

<img src="../img/fastqc_duplication.png" width="400" />

</p>

<h3 id="over-represented-sequences">Over-represented sequences</h3>

<p>The <strong>“Overrepresented sequences”</strong> table is another important module as it displays the sequences (at least 20 bp) that occur in more than 0.1% of the total number of sequences. This table aids in identifying contamination, such as vector or adapter sequences. If the %GC content was off in the above module, this table can help identify the source. If not listed as a known adapter or vector, it can help to BLAST the sequence to determine the identity.</p>

<p>Since our data is just a subset of the original data and it contains the over-expressed MOV10 gene, if we BLAST the sequences we will find they belong to MOV10. For this experiment, these over-represented sequences are not concerning.</p>

<p align="center">

<img src="../img/FastQC_contam.png" width="400" />

</p>

<hr />

<h2 id="summary">Summary</h2>

<p>As our report only represents a subset of reads (chromosome 1) for <code class="language-plaintext highlighter-rouge">Mov10_oe_1.subset.fq</code>, which can skew the QC results. We encourage you to look at the <a href="/modified-intro-to-rnaseq-hpc/fastqc/Mov10oe_1-fastqc_report.html">report for the full set of reads</a>, and note how the QC results differ when using the entire dataset.</p>

<p>If the quality of the raw data is acceptable, we can move on to the next step and quantify gene expression. Note that the quantification tools we use (salmon and STAR) are able to account for some of the quality issues that you may encounter like adapter contamination, vector contamination and low-quality bases at the ends of reads. It is not necessary (any more) to perform a trimming step prior to quantification.</p>

<hr />

<p><em>This lesson has been developed by members of the teaching team at the <a href="http://bioinformatics.sph.harvard.edu/">Harvard Chan Bioinformatics Core (HBC)</a>. These are open access materials distributed under the terms of the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution license</a> (CC BY 4.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</em></p>


      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="https://github.com/esallychang/modified-intro-to-rnaseq-hpc">modified-intro-to-rnaseq-hpc</a> is maintained by <a href="https://github.com/esallychang">esallychang</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </main>
  </body>
</html>
